Kraflo - Assistente de Ordens de Servi√ßo
Kraflo √© um bot do Telegram para automa√ß√£o e gerenciamento de Ordens de Servi√ßo (OS), projetado para ser robusto, escal√°vel e f√°cil de usar. A aplica√ß√£o √© constru√≠da em Python e utiliza um banco de dados PostgreSQL na nuvem (Supabase) para garantir a integridade e a seguran√ßa dos dados.

O objetivo do projeto √© fornecer uma ferramenta intuitiva para profissionais de campo (como mec√¢nicos e eletricistas) registrarem suas atividades di√°rias de forma eficiente, al√©m de permitir a gera√ß√£o de relat√≥rios detalhados para an√°lise e gest√£o.

üöÄ Principais Funcionalidades
ü§ñ Interface Conversacional: Intera√ß√£o completa atrav√©s do Telegram, com menus de bot√µes e um calend√°rio interativo para uma experi√™ncia de usu√°rio aprimorada.

üë§ Gest√£o de Usu√°rios: Sistema de cadastro que identifica a fun√ß√£o de cada profissional.

‚ûï Cria√ß√£o de OS: Fluxo guiado para abrir novas Ordens de Servi√ßo, detalhando o equipamento e o problema encontrado.

‚úîÔ∏è Fechamento de OS: Processo completo para finalizar uma OS, registrando a solu√ß√£o aplicada, pe√ßas utilizadas e observa√ß√µes.

üìÑ Relat√≥rios em PDF: Gera√ß√£o de relat√≥rios de atividades por dia, m√™s ou intervalo de datas personalizado.

üõ†Ô∏è Tecnologias Utilizadas
Backend: Python 3.10+

Framework do Bot: python-telegram-bot

Banco de Dados: PostgreSQL (gerenciado via Supabase)

Intera√ß√£o com Banco de Dados: supabase-py

Gera√ß√£o de PDF: fpdf2

Interface Interativa: python-telegram-bot-calendar

Ambiente: venv (Ambientes Virtuais) e python-dotenv (Gest√£o de Segredos)

Implanta√ß√£o (Deployment): Servidor Linux (Oracle Cloud)

Gerenciamento de Processos: systemd

‚öôÔ∏è Instala√ß√£o e Configura√ß√£o
Siga os passos abaixo para configurar e executar o projeto em um ambiente de desenvolvimento ou produ√ß√£o.

Pr√©-requisitos
Python 3.10 ou superior

Git

Uma conta no Supabase

Um token de bot do Telegram (obtido via @BotFather)

1. Clonar o Reposit√≥rio
git clone [https://github.com/lino167/kraflo.git](https://github.com/lino167/kraflo.git)
cd kraflo

2. Configurar o Ambiente Virtual e Depend√™ncias
√â uma boa pr√°tica isolar as depend√™ncias do projeto.

# Criar o ambiente virtual
python3 -m venv venv

# Ativar o ambiente (Linux/macOS)
source venv/bin/activate

# Ativar o ambiente (Windows)
# venv\Scripts\activate

# Instalar as bibliotecas necess√°rias
pip install -r requirements.txt

(O arquivo requirements.txt ser√° criado em uma etapa futura do nosso desenvolvimento)

3. Configurar o Banco de Dados (Supabase)
Acesse seu painel do Supabase, v√° para o SQL Editor do seu projeto e execute o script abaixo para criar as tabelas.

-- Tabela para armazenar os usu√°rios do sistema
CREATE TABLE public.usuarios (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    chat_id BIGINT UNIQUE NOT NULL,
    nome TEXT NOT NULL,
    funcao TEXT NOT NULL,
    nivel TEXT,
    setor TEXT,
    cadastro_empresa TEXT UNIQUE NOT NULL,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Tabela para armazenar as Ordens de Servi√ßo
CREATE TABLE public.ordens_servico (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    chat_id BIGINT NOT NULL,
    numero_maquina TEXT NOT NULL,
    modelo_maquina TEXT NOT NULL,
    tipo_manutencao TEXT NOT NULL,
    problema_apresentado TEXT NOT NULL,
    data_abertura TIMESTAMPTZ NOT NULL,
    data_fechamento TIMESTAMPTZ,
    solucao_aplicada TEXT,
    substituir_peca BOOLEAN,
    descricao_peca TEXT,
    tag_peca TEXT,
    servico_concluido BOOLEAN,
    observacao TEXT,
    -- Define a rela√ß√£o com a tabela de usu√°rios
    CONSTRAINT ordens_servico_chat_id_fkey FOREIGN KEY (chat_id)
    REFERENCES public.usuarios (chat_id) ON DELETE CASCADE
);

-- √çndices para otimizar as buscas
CREATE INDEX idx_os_data_abertura ON public.ordens_servico (data_abertura);
CREATE INDEX idx_os_chat_id ON public.ordens_servico (chat_id);

4. Configurar as Vari√°veis de Ambiente
Crie um arquivo chamado .env na raiz do projeto. Este arquivo n√£o √© enviado para o GitHub e guarda suas chaves secretas.

# .env

# Token do seu novo bot Kraflo obtido no @BotFather
TELEGRAM_BOT_TOKEN="SEU_TOKEN_AQUI"

# URL e Chave de API "anon" do seu projeto no Supabase
SUPABASE_URL="URL_DO_SEU_PROJETO_SUPABASE"
SUPABASE_KEY="SUA_CHAVE_DE_API_DO_SUPABASE"

‚ñ∂Ô∏è Como Usar
Ap√≥s seguir todos os passos de instala√ß√£o e configura√ß√£o:

Para Desenvolvimento Local:
Execute o bot diretamente no seu terminal (com o ambiente virtual ativado).

python bot.py

Para Produ√ß√£o:
O projeto √© implantado em um servidor Linux e gerenciado pelo systemd para garantir a execu√ß√£o cont√≠nua (24/7). Consulte a documenta√ß√£o interna do projeto ou os commits relacionados √† implanta√ß√£o para mais detalhes.

Este reposit√≥rio documenta o desenvolvimento completo da aplica√ß√£o, desde a concep√ß√£o at√© a implanta√ß√£o.